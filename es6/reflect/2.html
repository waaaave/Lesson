<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <input type="text" id="ele">
  <p id="result"></p>
  <script>
    const ele = document.getElementById('ele');
    ele.addEventListener('change',function(){
      console.log('change',this.value);
      result.innerHTML += this.value;
    })
    ele.value='change';
    // 派发事件
    // ele.dispatchEvent(new CustomEvent('change'));
    // 在new手写的时候 Object.create(protoObj) 可以做new 使用
    const props = Reflect.getOwnPropertyDescriptor(HTMLInputElement.prototype,'value')
    // console.log(props);
    Reflect.defineProperty(HTMLInputElement.prototype, 'value', {
      ...props,
      set(v){
        let oldv = this.value; // 旧的值
        props.set.call(this,v);
        if (oldv !== v){
          ele.dispatchEvent(new CustomEvent('change'));
        }
      }
    })
    ele.value = 'change'
  </script>
</body>
</html>